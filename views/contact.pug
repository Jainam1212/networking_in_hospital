<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  script(src="../js/emoji.js") 
  style 
    include ../css//contact.css
  style.
    h3{
      margin-top:10px;
      font-size:30px;
      color:red;
      text-align:center;
    }
    #doctorlist{
      display:none;
    }
    #timeslot_123{
      display:none;
    }
    .container {
      margin-top:20px;
      width: 300px;
      //- padding: 0 10px;
      background: #B4BED9;
      border-radius: 20px;
      //- padding: 10px 5px;
      display: flex;
      flex-direction: column;
      align-items: center;  
      text-align: center;
      justify-content: space-around;
      position: relative;
      transition: background .5s ease-in-out;
    }
    .title {
      font-size: 2rem;
      font-weight: 800;
      margin: 0 0 1rem 0;
      line-height: .9;
    }
    .subtitle {
      font-size: 1rem;
      margin: 0;
    }
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 30%;
      background: #e5e5e5;
      height: 2px;
      border-radius: 5px;
      outline: none;
      box-shadow: #f2d2bd;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      padding: 5px;
      height: 5px;
      width: 5px;
      border: 5px solid #fff;
      border-radius: 50%;
      cursor: pointer;
      background: #4c4c4c;
    }

    /* FIREFOX */
    input[type="range"]::-moz-range-thumb {
      padding: 5px;
      height: 5px;
      width: 5px;
      border: 5px solid #fff;
      border-radius: 50%;
      cursor: pointer;
      background: #4c4c4c;
    }

    .container img {
      height: 100px;
      width: 100px;
      outline: none;
      animation: dance 1s infinite;
    }
    .rating {
      font-size: 20px;
      font-weight: 100;
      width: 150px;
    }

    @keyframes dance {
      0%,
      100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }

</head>
<body>
  <section class="navbar">
    <div class="navbar_class">
      <div class="logo">
        <img src="/images/logo.jpg" alt="" srcset="">
      </div>
      <div class="list">
        <ul>
          <li class="item"><a href="/home">HOME</a></li>
          <li class="item"><a href="/treatment">TREATMENT</a></li>
          <li class="item"><a href="/appointments">APPOINTMENTS</a></li>
          <li class="item">
            a(href=locals.getlink) #{locals.buttonname}
          </li>
        </ul>
      </div>
    </div>
  </section>
  <section class="contact">
    <div class="formarea">
      <h1>Book your</h1>
      <h1>Appointment here</h1>
      h3  #{locals.message}
      <form action="/contact" method="post">
        <input type="text" name="patientname" placeholder="Patient's Name" required>
        <input type="number" name="patientage" placeholder="Your age" required>
        <select name="patientlocation" id="state123">
          <option value="">--Please choose your nearby location</option>
          <option value="Ahmedabad,Gujarat">Ahmedabad,Gujarat</option>
          <option value="Surat,Gujarat">Surat,Gujarat</option>
          <option value="Kutch,Gujarat">Kutch,Gujarat</option>
          <option value="Vadodara,Gujarat">Vadodara,Gujarat</option>
          <option value="Gandhinagar,Gujarat">Gandhinagar,Gujarat</option>
          <option value="Jamnagar,Gujarat">Jamnagar,Gujarat</option>
          <option value="Bhavnagar,Gujarat">Bhavnagar,Gujarat</option>
        </select>
        <input type="tel" name="patientphone" placeholder="Your Contact No." pattern="^\d{10}$" size="10" required title="Enter valid contact number">
        <input type="email" name="patientemail" placeholder="Your Email" required title="please enter valid email">
        <select name="patienthospital" id="hospital_123" required title="please select hospital you want to book appointment" oninput="getData()" oninput="getSlots()">
          <option value="">--Please choose a hospital</option>
          <option value="Apollo Hospitals">Apollo Hospitals</option>
          <option value="Zydus Hospital">Zydus Hospital</option>
          <option value="KD Hospital">KD Hospital</option>
          <option value="BJ medical">BJ medical</option>
          <option value="GMERS Hospital">GMERS Hospital</option>
          <option value="Shalby Hospital">Shalby Hospital</option>
          <option value="VS Clinic">VS Clinic</option>
        </select>
        <select name="patientneed" id="doctorcategory_123">
          <option value="">--Please choose category</option>
          <option value="Cardiologist">Cardiologist</option>
          <option value="Gynecologist">Gynecologist</option>
          <option value="Ayurvedic">Ayurvedic</option>
          <option value="Dermatologist">Dermatologist</option>
          <option value="Psychiatrist">Psychiatrist</option>
          <option value="ENT">ENT</option>
          <option value="Dentist">Dentist</option>
        </select>
        <select name="doctorallocated" id="doctorlist" required title="Select the doctor whom you want appointment with">
        </select>
        <input type="date" name="patientdate" placeholder="enter a date" required title="please select a date">
        <select name="patienttime" id="timeslot_123" required title='please select a time slot'>
        </select>
        <div class="container">
          <p class="title">Tell us how serious you feel your condition is</p>
          //- <p class="subtitle"></p>Tell us how serious is condition</p>
          <img src="https://essykings.github.io/JavaScript/svg-emojis/Neutral.svg" class="emoji"></img>
          <div class="rating">
            <p id="message">&nbsp;</p>
          </div>
          <input id="slider" name="feelSlider" type="range" min="0" max="100" value="50"/>
        </div>
        <button type="submit">Book Appointment</button>
      </form>
    </div>
    <div class="picture">
      <img src="/images/contact-img.jpg" alt="" srcset="">
    </div>
  </section>

  script(src="../js/emoji.js") 
  script. 
    function getData() {
      var element = document.getElementById('hospital_123');
      const selectedOption = element.options[element.selectedIndex].text;
      const url = `/getData?doctortoken=${selectedOption}`;
      //- console.log(selectedOption);
      fetch(url)
        .then(response => response.json())
        .then(data => {
          console.log(data);
          console.log('appending function');
          const dataSelect = document.getElementById('doctorlist');
          dataSelect.innerHTML = '';
          const option1 = document.createElement('option');
          option1.textContent = '--Available Doctors';
          dataSelect.appendChild(option1);
          data.forEach(item => {
            //- console.log(item.doctorname);
            const option = document.createElement('option');
            option.textContent = `${item.doctorname}`;
            dataSelect.appendChild(option);
          });
          document.getElementById('doctorlist').style.display = 'block';
        })
        .catch(error => console.error('Error fetching data:', error));


      var element1 = document.getElementById('hospital_123');
      const selectedOption1 = element1.options[element1.selectedIndex].text;
      const urltwo = `/getSlot?value=${selectedOption1}`;
      console.log('in slot');
      fetch(urltwo)
        .then(response => response.json())
        .then(data => {
          console.log(data);
          console.log(data[0].time);
          const dataSelect1 = document.getElementById('timeslot_123');
          dataSelect1.innerHTML = '';
          const option1 = document.createElement('option');
          option1.textContent = '--Please choose your slot';
          dataSelect1.appendChild(option1);
          var i = 0;
          data.forEach(item => {
            //- console.log(item.doctorname);
            const option2 = document.createElement('option');
            option2.value = `${data[i].time}`;
            option2.textContent = `${data[i].time} (${data[i].slot} slots available)`;
            i += 1;
            dataSelect1.appendChild(option2);
          });
          document.getElementById('timeslot_123').style.display = 'block';
        })
        .catch(error => console.error('Error fetching data:', error));
    }
    window.addEventListener("DOMContentLoaded", function () {
      const container = document.querySelector(".container");
      const slider = document.getElementById("slider");
      const emoji = document.querySelector(".emoji");
      const rate = document.getElementById("message");
      const colors = ["#d35e65", "#d3965c", "#cad48a", "#6ed494", "#18c574"];
      const emojis = [
        {
          text: "Awful",
          url: "https://assets.codepen.io/210284/Disappointed.svg",
        },
        {
          text: "Bad",
          url: "https://assets.codepen.io/210284/Sad.svg",
        },
        {
          text: "Okay",
          url: "https://assets.codepen.io/210284/Expressionless.svg",
        },
        {
          text: "Good",
          url: "https://assets.codepen.io/210284/Smile.svg",
        },
        {
          text: "Great",
          url: "https://assets.codepen.io/210284/Falling_in_love.svg",
        },
      ];

      function setProperties(index) {
        emoji.src = emojis[index].url;
        rate.textContent = emojis[index].text;
        container.style.backgroundColor = colors[index];
      }

      slider.addEventListener("input", UpdateRating);

      function UpdateRating() {
        const value = slider.value;

        if (value >= 0 && value < 20) {
          setProperties(0);
        } else if (value >= 20 && value < 40) {
          setProperties(1);
        } else if (value >= 40 && value < 60) {
          setProperties(2);
        } else if (value >= 60 && value < 80) {
          setProperties(3);
        } else if (value >= 80 && value <= 100) {
          setProperties(4);
        }
      }
    });
</body>
</html>